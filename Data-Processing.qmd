---
title: "Data Processing"
---

# Methods

## Data Acquisition

**Zillow Housing Data:**

-   Home Value Index (ZHVI): Metro_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv

-   Rent Index (ZORI): Metro_zori_uc_sfrcondomfr_sm_month.csv

-   Acquisition: Direct download from Zillow Research Data Portal

-   Coverage: Monthly values for all U.S. Metropolitan Statistical Areas, 2015-2025

**Census Income Data:**

-   Source: U.S. Census Bureau American Community Survey (ACS)

-   File: ACSST1Y2024.S1903-2025-11-19T223915.csv

-   Metric: Median Household Income by Metropolitan Area

-   Year: 2024 (most recent available)

**Mortgage Rate Data:**

-   Source: Federal Reserve Economic Data (FRED)

-   File: MORTGAGE30US.csv

-   Metric: 30-Year Fixed Mortgage Rate

-   Period: 2014-2025

**Data Loading**

```{r, eval=FALSE}
library(readr)
Census_Income_Data <- read_csv("ACSST1Y2024.S1903-2025-11-19T223915.csv")
Metropolitan_level_Zillow_Home_Value_Index <- read_csv("Metro_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv")
Zillow_Observed_Rent_Index <- read_csv("Metro_zori_uc_sfrcondomfr_sm_month.csv")
Mortage_interest_rates <- read_csv("MORTGAGE30US.csv")
```

## Data Cleaning

**Home Value Data Processing**

```{r}
library(dplyr)
library(tidyverse)
Census_Income_Data <- read_csv("ACSST1Y2024.S1903-2025-11-19T223915.csv")
Metropolitan_level_Zillow_Home_Value_Index <- read_csv("Metro_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv")
Zillow_Observed_Rent_Index <- read_csv("Metro_zori_uc_sfrcondomfr_sm_month.csv")
Mortage_interest_rates <- read_csv("MORTGAGE30US.csv")

# Clean home value data
home_data_clean <- Metropolitan_level_Zillow_Home_Value_Index %>%
  # Select relevant columns
  select(RegionID, RegionName, StateName, SizeRank, 
         matches("^\\d{4}-\\d{2}-\\d{2}$")) %>%
  # Filter to complete cases
  filter(complete.cases(`2015-01-31`, `2025-01-31`)) %>%
  # Calculate key metrics
  mutate(
    current_price = `2025-01-31`,
    price_2015 = `2015-01-31`,
    price_growth_pct = (current_price - price_2015) / price_2015 * 100
  )

```

**Rental Data Processing**

```{r}
# Clean rental data
rent_data_clean <- Zillow_Observed_Rent_Index %>%
  # Select relevant columns
  select(RegionID, RegionName, StateName, SizeRank,
         matches("^\\d{4}-\\d{2}-\\d{2}$")) %>%
  # Filter to complete cases
  filter(complete.cases(`2015-01-31`, `2025-01-31`)) %>%
  # Calculate key metrics
  mutate(
    current_rent = `2025-01-31`,
    rent_2015 = `2015-01-31`,
    rent_growth_pct = (current_rent - rent_2015) / rent_2015 * 100
  )

# Summary of rental data cleaning
rent_summary <- rent_data_clean %>%
  summarize(
    n_markets = n(),
    avg_rent_2025 = mean(current_rent, na.rm = TRUE),
    avg_rent_growth = mean(rent_growth_pct, na.rm = TRUE)
  )
```

## Exploratory Data Analysis

```{r}
# Prepare time series data for trend analysis
time_series_home <- Metropolitan_level_Zillow_Home_Value_Index %>%
  select(RegionName, StateName, matches("^\\d{4}-\\d{2}-\\d{2}$")) %>%
  pivot_longer(
    cols = matches("^\\d{4}-\\d{2}-\\d{2}$"),
    names_to = "date",
    values_to = "home_value"
  ) %>%
  mutate(
    date = as.Date(date),
    year = year(date),
    quarter = quarter(date)
  ) %>%
  group_by(RegionName, StateName, year) %>%
  summarize(
    avg_home_value = mean(home_value, na.rm = TRUE),
    .groups = "drop"
  )

# Prepare rental time series
time_series_rent <- Zillow_Observed_Rent_Index %>%
  select(RegionName, StateName, matches("^\\d{4}-\\d{2}-\\d{2}$")) %>%
  pivot_longer(
    cols = matches("^\\d{4}-\\d{2}-\\d{2}$"),
    names_to = "date",
    values_to = "rent_value"
  ) %>%
  mutate(
    date = as.Date(date),
    year = year(date)
  ) %>%
  group_by(RegionName, StateName, year) %>%
  summarize(
    avg_rent = mean(rent_value, na.rm = TRUE),
    .groups = "drop"
  )
```

## Key Metrics Calculation

1.  Growth Calculations:

    -   Annual growth rates: (current_value - previous_value) / previous_value \* 100

    -   Cumulative growth: (2025_value - 2015_value) / 2015_value \* 100

2.  Affordability Metrics:

    -   Price-to-Income Ratio: median_home_price / median_income

    -   Rent Burden: (annual_rent / median_income) \* 100

3.  Regional Aggregations:

    -   Average growth by region

    -   Median prices by state groups

    -   Market categorizations (expensive, affordable, high-growth)

4.  Distribution Statistics:

    -   Percentile rankings for home prices and growth rates

    -   Standard deviations from national averages

    -   Interquartile ranges for affordability metrics
